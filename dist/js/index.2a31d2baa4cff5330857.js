(()=>{var n={553:e=>{var t=function(a){"use strict";var e=Object.prototype;var s=e.hasOwnProperty;var u;var t=typeof Symbol==="function"?Symbol:{};var o=t.iterator||"@@iterator";var r=t.asyncIterator||"@@asyncIterator";var n=t.toStringTag||"@@toStringTag";function i(e,t,r){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true});return e[t]}try{i({},"")}catch(e){i=function(e,t,r){return e[t]=r}}function c(e,t,r,n){var o=t&&t.prototype instanceof l?t:l;var i=Object.create(o.prototype);var a=new C(n||[]);i._invoke=L(e,r,a);return i}a.wrap=c;function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}var h="suspendedStart";var d="suspendedYield";var p="executing";var v="completed";var m={};function l(){}function y(){}function w(){}var g={};g[o]=function(){return this};var b=Object.getPrototypeOf;var x=b&&b(b(_([])));if(x&&x!==e&&s.call(x,o)){g=x}var k=w.prototype=l.prototype=Object.create(g);y.prototype=k.constructor=w;w.constructor=y;y.displayName=i(w,n,"GeneratorFunction");function S(e){["next","throw","return"].forEach(function(t){i(e,t,function(e){return this._invoke(t,e)})})}a.isGeneratorFunction=function(e){var t=typeof e==="function"&&e.constructor;return t?t===y||(t.displayName||t.name)==="GeneratorFunction":false};a.mark=function(e){if(Object.setPrototypeOf){Object.setPrototypeOf(e,w)}else{e.__proto__=w;i(e,n,"GeneratorFunction")}e.prototype=Object.create(k);return e};a.awrap=function(e){return{__await:e}};function E(c,u){function l(e,t,r,n){var o=f(c[e],c,t);if(o.type==="throw"){n(o.arg)}else{var i=o.arg;var a=i.value;if(a&&typeof a==="object"&&s.call(a,"__await")){return u.resolve(a.__await).then(function(e){l("next",e,r,n)},function(e){l("throw",e,r,n)})}return u.resolve(a).then(function(e){i.value=e;r(i)},function(e){return l("throw",e,r,n)})}}var t;function e(r,n){function e(){return new u(function(e,t){l(r,n,e,t)})}return t=t?t.then(e,e):e()}this._invoke=e}S(E.prototype);E.prototype[r]=function(){return this};a.AsyncIterator=E;a.async=function(e,t,r,n,o){if(o===void 0)o=Promise;var i=new E(c(e,t,r,n),o);return a.isGeneratorFunction(t)?i:i.next().then(function(e){return e.done?e.value:i.next()})};function L(a,c,u){var l=h;return function e(t,r){if(l===p){throw new Error("Generator is already running")}if(l===v){if(t==="throw"){throw r}return P()}u.method=t;u.arg=r;while(true){var n=u.delegate;if(n){var o=O(n,u);if(o){if(o===m)continue;return o}}if(u.method==="next"){u.sent=u._sent=u.arg}else if(u.method==="throw"){if(l===h){l=v;throw u.arg}u.dispatchException(u.arg)}else if(u.method==="return"){u.abrupt("return",u.arg)}l=p;var i=f(a,c,u);if(i.type==="normal"){l=u.done?v:d;if(i.arg===m){continue}return{value:i.arg,done:u.done}}else if(i.type==="throw"){l=v;u.method="throw";u.arg=i.arg}}}}function O(e,t){var r=e.iterator[t.method];if(r===u){t.delegate=null;if(t.method==="throw"){if(e.iterator["return"]){t.method="return";t.arg=u;O(e,t);if(t.method==="throw"){return m}}t.method="throw";t.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var n=f(r,e.iterator,t.arg);if(n.type==="throw"){t.method="throw";t.arg=n.arg;t.delegate=null;return m}var o=n.arg;if(!o){t.method="throw";t.arg=new TypeError("iterator result is not an object");t.delegate=null;return m}if(o.done){t[e.resultName]=o.value;t.next=e.nextLoc;if(t.method!=="return"){t.method="next";t.arg=u}}else{return o}t.delegate=null;return m}S(k);i(k,n,"Generator");k[o]=function(){return this};k.toString=function(){return"[object Generator]"};function j(e){var t={tryLoc:e[0]};if(1 in e){t.catchLoc=e[1]}if(2 in e){t.finallyLoc=e[2];t.afterLoc=e[3]}this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal";delete t.arg;e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}];e.forEach(j,this);this.reset(true)}a.keys=function(r){var n=[];for(var e in r){n.push(e)}n.reverse();return function e(){while(n.length){var t=n.pop();if(t in r){e.value=t;e.done=false;return e}}e.done=true;return e}};function _(t){if(t){var e=t[o];if(e){return e.call(t)}if(typeof t.next==="function"){return t}if(!isNaN(t.length)){var r=-1,n=function e(){while(++r<t.length){if(s.call(t,r)){e.value=t[r];e.done=false;return e}}e.value=u;e.done=true;return e};return n.next=n}}return{next:P}}a.values=_;function P(){return{value:u,done:true}}C.prototype={constructor:C,reset:function(e){this.prev=0;this.next=0;this.sent=this._sent=u;this.done=false;this.delegate=null;this.method="next";this.arg=u;this.tryEntries.forEach(T);if(!e){for(var t in this){if(t.charAt(0)==="t"&&s.call(this,t)&&!isNaN(+t.slice(1))){this[t]=u}}}},stop:function(){this.done=true;var e=this.tryEntries[0];var t=e.completion;if(t.type==="throw"){throw t.arg}return this.rval},dispatchException:function(r){if(this.done){throw r}var n=this;function e(e,t){i.type="throw";i.arg=r;n.next=e;if(t){n.method="next";n.arg=u}return!!t}for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];var i=o.completion;if(o.tryLoc==="root"){return e("end")}if(o.tryLoc<=this.prev){var a=s.call(o,"catchLoc");var c=s.call(o,"finallyLoc");if(a&&c){if(this.prev<o.catchLoc){return e(o.catchLoc,true)}else if(this.prev<o.finallyLoc){return e(o.finallyLoc)}}else if(a){if(this.prev<o.catchLoc){return e(o.catchLoc,true)}}else if(c){if(this.prev<o.finallyLoc){return e(o.finallyLoc)}}else{throw new Error("try statement without catch or finally")}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&s.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}if(o&&(e==="break"||e==="continue")&&o.tryLoc<=t&&t<=o.finallyLoc){o=null}var i=o?o.completion:{};i.type=e;i.arg=t;if(o){this.method="next";this.next=o.finallyLoc;return m}return this.complete(i)},complete:function(e,t){if(e.type==="throw"){throw e.arg}if(e.type==="break"||e.type==="continue"){this.next=e.arg}else if(e.type==="return"){this.rval=this.arg=e.arg;this.method="return";this.next="end"}else if(e.type==="normal"&&t){this.next=t}return m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e){this.complete(r.completion,r.afterLoc);T(r);return m}}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if(n.type==="throw"){var o=n.arg;T(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){this.delegate={iterator:_(e),resultName:t,nextLoc:r};if(this.method==="next"){this.arg=u}return m}};return a}(true?e.exports:0);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}},757:(e,t,r)=>{e.exports=r(553)},91:e=>{"use strict";e.exports=function(e,t){if(!t){t={}}if(!e){return e}e=String(e.__esModule?e.default:e);if(t.hash){e+=t.hash}if(t.maybeNeedQuotes&&/[\t\n\f\r "'=<>`]/.test(e)){return'"'.concat(e,'"')}return e}},761:(e,t,r)=>{"use strict";e.exports=r.p+"b88d04fba731603756b1.css"}};var o={};function g(e){var t=o[e];if(t!==undefined){return t.exports}var r=o[e]={exports:{}};n[e](r,r.exports,g);return r.exports}g.m=n;(()=>{g.n=e=>{var t=e&&e.__esModule?()=>e["default"]:()=>e;g.d(t,{a:t});return t}})();(()=>{g.d=(e,t)=>{for(var r in t){if(g.o(t,r)&&!g.o(e,r)){Object.defineProperty(e,r,{enumerable:true,get:t[r]})}}}})();(()=>{g.g=function(){if(typeof globalThis==="object")return globalThis;try{return this||new Function("return this")()}catch(e){if(typeof window==="object")return window}}()})();(()=>{g.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})();(()=>{var e;if(g.g.importScripts)e=g.g.location+"";var t=g.g.document;if(!e&&t){if(t.currentScript)e=t.currentScript.src;if(!e){var r=t.getElementsByTagName("script");if(r.length)e=r[r.length-1].src}}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/");g.p=e+"../"})();(()=>{g.b=document.baseURI||self.location.href;var e={826:0}})();var e={};(()=>{"use strict";var e=g(91);var t=g.n(e);var r=new URL(g(761),g.b);var n=t()(r);var o='<!DOCTYPE html> <html lang="en"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width,initial-scale=1"> <title>Document</title> <link rel="stylesheet" href="'+n+'"> </head> <body> <style>#map,body,html{width:100%;height:100%;padding:0;margin:0}.form{width:300px}.form .field{width:100%;margin-bottom:10px}.form .field input,.form .field textarea{width:100%;box-sizing:border-box}.form .field textarea{resize:none}.form .form-error{color:red}.form .review-list{max-height:500px;overflow:scroll}.btn{background:#ff8663;border-radius:3px}</style> <div id="map"></div> <script type="template" id="addFormTemplate"> <div class="review-list"></div>\r\n        <div class="form" data-role="review-form">\r\n            <hr color="#E7E7E7" size="1" noshade>\r\n            <h3>Отзыв:</h3>\r\n            <div class="field">\r\n                <input data-role="review-name" type="text" placeholder="Укажите ваше имя" >\r\n            </div>\r\n            <div class="field">\r\n                <input data-role="review-place" type="text" placeholder="Укажите место" >\r\n            </div>\r\n            <div class="field">\r\n                <textarea data-role="review-text" placeholder="Оставьте отзыв" rows="5" ></textarea>\r\n            </div>\r\n    \r\n            <button data-role="review-add" class="btn">Добавить</button>\r\n            <span class="form-error"></span>\r\n        </div> <\/script> </body> </html>';const i=null&&o;function u(e,t,r,n,o,i,a){try{var c=e[i](a);var u=c.value}catch(e){r(e);return}if(c.done){t(u)}else{Promise.resolve(u).then(n,o)}}function a(c){return function(){var e=this,a=arguments;return new Promise(function(t,r){var n=c.apply(e,a);function o(e){u(n,t,r,o,i,"next",e)}function i(e){u(n,t,r,o,i,"throw",e)}o(undefined)})}}function c(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function s(e,t,r){if(t)l(e.prototype,t);if(r)l(e,r);return e}var f=g(757);var h=g.n(f);var d=function(){function r(e,t){c(this,r);this.mapId=e;this.onClick=t}s(r,[{key:"init",value:function(){var e=a(h().mark(function e(){return h().wrap(function e(t){while(1){switch(t.prev=t.next){case 0:t.next=2;return this.injectYMapsScript();case 2:t.next=4;return this.loadYMaps();case 4:this.initMap();case 5:case"end":return t.stop()}}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"injectYMapsScript",value:function e(){return new Promise(function(e){var t=document.createElement("script");t.src="https://api-maps.yandex.ru/2.1/?apikey=5a4c2cfe-31f1-4007-af4e-11db22b6954b&lang=ru_RU";document.body.appendChild(t);t.addEventListener("load",e)})}},{key:"loadYMaps",value:function e(){return new Promise(function(e){return ymaps.ready(e)})}},{key:"initMap",value:function e(){var r=this;this.clusterer=new ymaps.Clusterer({groupByCoordinates:true,clusterDisableClickZoom:true,clusterOpenBalloonOnClick:false});this.clusterer.events.add("click",function(e){var t=e.get("target").geometry.getCoordinates();r.onClick(t)});this.map=new ymaps.Map(this.mapId,{center:[59.94,30.32],zoom:12});this.map.events.add("click",function(e){return r.onClick(e.get("coords"))});this.map.geoObjects.add(this.clusterer)}},{key:"openBalloon",value:function e(t,r){this.map.balloon.open(t,r)}},{key:"setBalloonContent",value:function e(t){this.map.balloon.setData(t)}},{key:"closeBalloon",value:function e(){this.map.balloon.close()}},{key:"createPlacemark",value:function e(t){var r=this;var n=new ymaps.Placemark(t);n.events.add("click",function(e){var t=e.get("target").geometry.getCoordinates();r.onClick(t)});this.clusterer.add(n)}}]);return r}();function p(t,e){var r=typeof Symbol!=="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=v(t))||e&&t&&typeof t.length==="number"){if(r)t=r;var n=0;var o=function e(){};return{s:o,n:function e(){if(n>=t.length)return{done:true};return{done:false,value:t[n++]}},e:function e(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i=true,a=false,c;return{s:function e(){r=r.call(t)},n:function e(){var t=r.next();i=t.done;return t},e:function e(t){a=true;c=t},f:function e(){try{if(!i&&r["return"]!=null)r["return"]()}finally{if(a)throw c}}}}function v(e,t){if(!e)return;if(typeof e==="string")return m(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor)r=e.constructor.name;if(r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return m(e,t)}function m(e,t){if(t==null||t>e.length)t=e.length;for(var r=0,n=new Array(t);r<t;r++){n[r]=e[r]}return n}var y=localStorage;var w=function(){function e(){c(this,e);this.formTemplate=document.querySelector("#addFormTemplate").innerHTML;this.map=new d("map",this.onClick.bind(this));this.map.init().then(this.onInit.bind(this))}s(e,[{key:"onInit",value:function(){var e=a(h().mark(function e(){var r,n,o,i,a;return h().wrap(function e(t){while(1){switch(t.prev=t.next){case 0:a=function e(t){if(t.target.dataset.role==="review-add"){var r=document.querySelector("[data-role=review-name]");var n=document.querySelector("[data-role=review-place]");var o=document.querySelector("[data-role=review-text]");var i=document.querySelector(".form-error");if(r.value!=""&&n.value!=""&&o.value!=""){var a=document.querySelector("[data-role=review-form]");var c=JSON.parse(y.getItem("review")||"[]");var u=JSON.parse(a.dataset.coords);c.push({name:document.querySelector("[data-role=review-name]").value,place:document.querySelector("[data-role=review-place]").value,text:document.querySelector("[data-role=review-text]").value,coords:u});y.setItem("review",JSON.stringify(c));this.map.createPlacemark(u);this.map.closeBalloon()}else{i.innerText="Заполните каждое поле"}}};t.next=3;return Object.values(JSON.parse(y.getItem("review"))||{});case 3:r=t.sent;n=p(r);try{for(n.s();!(o=n.n()).done;){i=o.value;this.map.createPlacemark(i.coords)}}catch(e){n.e(e)}finally{n.f()}document.body.addEventListener("click",a.bind(this));case 7:case"end":return t.stop()}}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"createForm",value:function e(t,r){var n=document.createElement("div");n.innerHTML=this.formTemplate;var o=n.querySelector(".review-list");o.style.height="140px";o.style.overflow="scroll";var i=n.querySelector("[data-role=review-form]");i.dataset.coords=JSON.stringify(t);var a=p(r),c;try{for(a.s();!(c=a.n()).done;){var u=c.value;if(JSON.stringify(u.coords)==JSON.stringify(t)){var l=document.createElement("div");l.classList.add("review-item");l.style.color="#8F8F8F";l.innerHTML='\n          <div>\n            <b style = "color: black">'.concat(u.name,"</b> ").concat(u.place,"\n          </div>\n          <div>").concat(u.text,"</div>\n          ");o.appendChild(l)}}}catch(e){a.e(e)}finally{a.f()}return n}},{key:"onClick",value:function(){var t=a(h().mark(function e(r){var n,o;return h().wrap(function e(t){while(1){switch(t.prev=t.next){case 0:this.map.openBalloon(r);t.next=3;return JSON.parse(y.getItem("review")||"[]");case 3:n=t.sent;o=this.createForm(r,n);this.map.setBalloonContent(o.innerHTML);case 6:case"end":return t.stop()}}},e,this)}));function e(e){return t.apply(this,arguments)}return e}()}]);return e}();new w})()})();